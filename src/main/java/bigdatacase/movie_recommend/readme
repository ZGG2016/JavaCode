
step1:
    map    输入：<userID  movieID,pref>
           输出：<movieID  userID,pref>

    reduce 输入：<movieID  userID,pref>
           输出：<userID1,userID2  pref1,pref2>

step2: 计算相似度
    map    输入：<userID1,userID2  pref1,pref2>
           输出：<userID1,userID2  pref1,pref2>

    reduce 输入：<userID1,userID2  pref1,pref2>
           输出：<userID1,userID2  similarity>

step3: 取相似度最高的前两个用户
    map    输入：<userID1,userID2  similarity>
           输出：<userID1  userID2,similarity>

    reduce 输入：<userID1  userID2,similarity>
           输出: <userID1  userID2,similarity,userID3,similarity>

step4:
    map    输入：<userID  movieID,pref>
           输出：<movieID  userID,pref>

step5: 取预测评分
    map    输入：step3-output:<userID1  userID2,similarity,userID3,similarity>
                step4-output:<movieID,userID,pref>
           输出：<movieID A:userID1,userID2,userID3>
                <movieID B:userID,pref>
    reduce 输入：<movieID A:userID1,userID2,userID3>
             	<movieID B:userID,pref>
           输出：<userID  movieID,average pref>

step6: 取预测评分最高
    map    输入：<userID  movieID,average pref>
           输出：<userID  movieID,average pref>
    reduce 输入：<userID  movieID,average pref>
           输出：<userID  {movieID,average pref}>

step7、step8:将电影id换成电影名

========================================================================================

1.原始数据输入

1,101,5.0

1,102,3.0

1,103,2.5

2,101,2.0

2,102,2.5

2,103,5.0

2,104,2.0

3,101,2.5

3,104,4.0

3,105,4.5

3,107,5.0

4,101,5.0

4,103,3.0

4,104,4.5

4,106,4.0

5,101,4.0

5,102,3.0

5,103,2.0

5,104,4.0

5,105,3.5

5,106,4.0



2.构成矩阵

     101 102 103 104 105 106 107

[1,] 5.0 3.0 2.5 0.0 0.0   0   0

[2,] 2.0 2.5 5.0 2.0 0.0   0   0

[3,] 2.5 0.0 0.0 4.0 4.5   0   5

[4,] 5.0 0.0 3.0 4.5 0.0   4   0

[5,] 4.0 3.0 2.0 4.0 3.5   4   0



3.欧氏相似矩阵转换

          [,1]      [,2]      [,3]      [,4]      [,5]

[1,] 0.0000000 0.6076560 0.2857143 1.0000000 1.0000000

[2,] 0.6076560 0.0000000 0.6532633 0.5568464 0.7761999

[3,] 0.2857143 0.6532633 0.0000000 0.5634581 1.0000000

[4,] 1.0000000 0.5568464 0.5634581 0.0000000 1.0000000

[5,] 1.0000000 0.7761999 1.0000000 1.0000000 0.0000000



计算方式：

相似度＝n/(1+sqrt(sum((Xi-Yi)^2)))

即需要对两个向量元素做差值并平方再求和再开方，开方后加1，最后n是有效向量差值个数。

如用户1和用户2的相似度计算：

(5.0-2.0)^2 + (3.0-2.5)^2 + (2.5-5.0)^2 = 15.5  //之所以只有3个向量元素做差值 是因为要两个向量元素都为非0值才做差值计算

3/(1+sqrt(15.5)) = 0.607656